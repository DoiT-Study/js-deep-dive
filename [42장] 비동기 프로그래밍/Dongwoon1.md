# 42장 비동기 프로그래밍

## 42.1 동기 처리와 비동기 처리
자바스크립트 엔진은 단 하나의 실행 컨테스트를 갖으므로 2개 이상의 함수가 동시에 실행될 수 없다.

즉, 싱글 스레드 방식으로 동작하여 시간이 많이 지연되고 이로 인해 블로킹이라는 작업 중단 문제가 발생한다. 

시간이 많이 지연되는 이유는 싱글 스레드에서도 하나의 태스크가 실행될 때까지 다른 태스크는 대기 상태이기 때문이다.

이러한 대기하는 방식을 **동기 처리**라고 하며 장점은 태스크마다의 실행 순서가 보장된다는 점이다.

반대로 실행 중인 태스크가 있음에도 다음 태스크를 실행하는 방식을 **비동기 처리**라고 한다.

비동기 처리는 블로킹이 일어나지 않는다는 장점이 있지만 명확한 실행 순서가 보장되지 않는다.

## 42.2 이벤트 루프와 태스크 큐
이벤트 루프란 마치 태스크가 동시에 보이게 하는 기능이다.

브라우저에 자동으로 내장되어 있고 자바스크립트의 동시성을 지원해준다. 

원래 자바스크립트는 힙과 콜 스택으로 구성되어 있는데 태스크가 요청되면 콜 스택을 통해 순차적으로 실행된다.

여기서 실행은 브라우저와 Node.js가 관여하며 비동기 방식인 setTimeout의 콜백 함수의 실행은 자바 스크립트 엔진이 관여한다.

그러나 콜백 함수에서의 타이머 설정과 등록은 브라우저가 관여하는데 여기서 이벤트 루프와 태스크 큐가 작동하는 것이다.

태스크 큐는 비동기 함수가 일시적으로 보관되는 영역으로 생각하면된다.

1. 이벤트 루프는 먼저 콜 스택에서 실행 중인 태스크가 있는지 확인하고 태스크 큐에 대기 중인 함수가 있는지 확인한다.

2. 만약 콜 스택이 비어있고 대기 중인 함수가 있다면 대기 중인 함수를 콜 스택으로 이동시킨다.

3. 이동된 함수는 실행되어 동시에 작동하게 보이는 것이다.

따라서, 자바 스크립트 엔진은 싱글 스레드 방식으로 작동하지만 브라우저는 멀티 스레드 방식으로 작동한다.

이를 어길 경우 자바스크립트는 비동기 방식으로 동작할 수 없다.
